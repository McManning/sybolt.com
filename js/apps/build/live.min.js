/*! Sybolt 30-08-2015 */

!function(){define("live/models/live",["underscore","backbone"],function(a,b){"use strict";var c=b.Model.extend({urlRoot:"http://dev.sybolt.com:25554/live",defaults:{polling_interval:5e3},initialize:function(){this.polling=!1,this.publisher=null,this.viewers=[],a.bindAll(this,"executePolling","onFetch","onFetchError")},isPublishing:function(){return!this.hasError()&&this.get("publishing")===!0},hasError:function(){return void 0!==this.get("error")},startPolling:function(){this.polling=!0,this.executePolling()},stopPolling:function(){this.polling=!1},executePolling:function(){this.fetch({success:this.onFetch,error:this.onFetchError})},onFetchError:function(a){this.set("error","Error while syncing to Live API"),this.onFetch()},onFetch:function(){this.polling&&setTimeout(this.executePolling,this.get("polling_interval"))},parse:function(a,b){return"publisher"in a?this.publisher=a.publisher:this.publisher=null,{publishing:a.publishing,rtmp_url:a.rtmp_url,stream_path:a.stream_path,error:a.error}}});return c}),define("text!live/templates/viewers.html",[],function(){return'\r\n<div class="content-left">\r\n    <% if (viewers.length === 1) { %>\r\n        <h1 class="full-width">1 VIEWER</h1>\r\n    <% } else { %>\r\n        <h1 class="full-width"><%= viewers.length %> VIEWERS</h1>\r\n    <% } %>\r\n\r\n    <div class="profiles-collection">\r\n        <% _.each(viewers, function(profile) { %>            \r\n            <div class="profile-icon"><img src="/img/default-profile-icon.png"/></div>\r\n        <% }); %>\r\n    </div>\r\n\r\n    <div class="clearfix"></div>\r\n</div>\r\n'}),define("live/views/viewers",["jquery","underscore","backbone","text!live/templates/viewers.html"],function(a,b,c,d){var e=c.View.extend({template:b.template(d),initialize:function(){},close:function(){this.remove()},onAddViewer:function(a){console.log("ADD VIEWER: ",a),this.render()},onRemoveViewer:function(a){console.log("REMOVE VIEWER: ",a),this.render()},onUpdateViewer:function(a){console.log("UPDATE VIEWER: ",a),this.render()},onClearViewers:function(){this.render()},render:function(){return!this.model.viewers||this.model.viewers.length<1?this.$el.addClass("hidden"):this.$el.removeClass("hidden").html(this.template({viewers:this.model.viewers,publisher:this.model.publisher})),this}});return e}),define("text!live/templates/schedule.html",[],function(){return'\r\n<div class="content-left">\r\n    <h1 class="full-width">SCHEDULE <button class="show-request bordered">Request a movie</button></h1>\r\n\r\n    <!--h2>THEME: <%- theme %></h2-->\r\n\r\n    <div class="nav">\r\n        <% if (last_month !== null && last_month.length > 0) { %>\r\n        <button id="last-month" type="button" class="bordered large"><%- last_month %> </button>\r\n        <% } %>\r\n\r\n        <span id="this-month"><%- this_month %></span>\r\n\r\n        <% if (next_month !== null && next_month.length > 0) { %>\r\n        <button id="next-month" type="button" class="bordered large"><%- next_month %></button>\r\n        <% } %>\r\n    </div>\r\n\r\n    <% if (movie_dates.length < 1) { %>\r\n        <div class="no-schedule">\r\n            <h1>No movies have been scheduled for this month</h1>\r\n        </div>\r\n    <% } else { %>\r\n\r\n        <!-- Render containers for each schedule-card to render in via their own views -->\r\n        <% _.each(movie_dates, function(date) { %>    \r\n        <div id="schedule-card-<%= date %>" class="schedule-card-container"></div>    \r\n        <% }); %>\r\n\r\n    <% } %>\r\n\r\n    <% if (profile) { %>\r\n        <a id="add-schedule-card" href="#">Add New Movie</a>\r\n    <% } %>\r\n</div>\r\n'}),define("text!live/templates/schedulecard.html",[],function(){return'\r\n<div class="schedule-card">\r\n    <!-- Card with picker icon, date, and movie title -->\r\n    <div class="title">\r\n\r\n        <% if (movie.profile !== null) { %>  \r\n            <img src="<%- movie.profile.avatar_url %>" />\r\n        <% } else { %>\r\n            \r\n        <% } %>\r\n\r\n        <h2><%- movie.date_fmt %></h2>\r\n\r\n        <% if (movie.title !== null && movie.title.length > 0) { %>\r\n            <p><%- movie.title %></p>\r\n        <% } else { %> \r\n            <p><i>Not yet announced</i></p>\r\n        <% } %>\r\n    </div>\r\n\r\n    <!-- Card with poster, synopsis, and links -->\r\n    <div class="details">\r\n        <div class="poster-container">\r\n            <% if (movie.poster !== null && movie.poster.length > 0) { %>\r\n                <img class="poster" src="<%- movie.poster %>" />\r\n            <% } else { %>\r\n                <img class="poster" src="/img/movie-tba.png" />\r\n            <% } %>\r\n        </div>\r\n\r\n        <div class="content">\r\n            <% if (movie.synopsis !== null && movie.synopsis.length > 0) { %>\r\n            <strong>Synopsis</strong>\r\n            <p class="synopsis">\r\n                <%- movie.synopsis %>\r\n            </p>\r\n            <% } %>\r\n\r\n            <% if (movie.profile !== null) { %>  \r\n                <strong>Picked By</strong>\r\n                <p class="picked-by">\r\n                    <%- movie.profile.username %>\r\n                </p>\r\n            <% } else { %>\r\n                <strong>Not yet assigned to a member</strong>\r\n            <% } %>\r\n\r\n            <ul class="links">\r\n                <% if (movie.trailer !== null && movie.trailer.length > 0) { %> \r\n                    <li>\r\n                        <a class="trailer" data-bypass="true" target="_BLANK" href="<%- movie.trailer %>">Watch the Trailer</a>\r\n                    </li> \r\n                <% } %>\r\n\r\n                <% if (movie.imdb !== null && movie.imdb.length > 0) { %> \r\n                    <li>\r\n                        <a class="imdb" data-bypass="true" target="_BLANK" href="<%- movie.imdb %>">View on IMDb</a>\r\n                    </li> \r\n                <% } %>\r\n            </ul>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Editor to modify movie details -->\r\n    <div class="editor hidden">\r\n        <form class="small">\r\n            <fieldset class="full">\r\n                <div class="text">\r\n                    <label for="date-<%- movie.id %>">DATE</label>\r\n                    <input type="text" id="date-<%- movie.id %>" name="date" value="<%- movie.date %>" />\r\n                </div>\r\n                <div class="text">\r\n                    <label for="title-<%- movie.id %>">TITLE</label>\r\n                    <input type="text" id="title-<%- movie.id %>" name="title" value="<%- movie.title %>" />\r\n                </div>\r\n                <div class="textarea">\r\n                    <label for="synopsis-<%- movie.id %>">SYNOPSIS</label>\r\n                    <textarea id="synopsis-<%- movie.id %>" name="synopsis" rows="4"><%- movie.synopsis %></textarea>\r\n                </div>\r\n                <div class="text">\r\n                    <label for="trailer-<%- movie.id %>">TRAILER</label>\r\n                    <input type="text" id="trailer-<%- movie.id %>" name="trailer" value="<%- movie.trailer %>" />\r\n                </div>\r\n                <div class="text">\r\n                    <label for="imdb-<%- movie.id %>">IMDB</label>\r\n                    <input type="text" id="imdb-<%- movie.id %>" name="imdb" value="<%- movie.imdb %>" />\r\n                </div>\r\n                <div class="text">\r\n                    <label for="poster-<%- movie.id %>">POSTER</label>\r\n                    <input type="text" id="poster-<%- movie.id %>" name="poster" value="<%- movie.poster %>" />\r\n                </div>\r\n                <div class="text">\r\n                    <label for="profile-<%- movie.id %>">USER</label>\r\n                    <input type="text" id="profile-<%- movie.id %>" name="profile" value="<%- (movie.profile) ? movie.profile.username : \'\' %>" />\r\n                </div>\r\n            </fieldset>\r\n\r\n            <div class="controls">\r\n                <button type="button" class="cancel-edit">Cancel</button>\r\n                <button type="submit" class="save-edit bordered green">Save Changes</button>\r\n            </div>\r\n\r\n            <div class="clearfix"></div>\r\n        </form>\r\n    </div>\r\n\r\n</div>\r\n'}),define("live/views/schedulecard",["jquery","underscore","backbone","text!live/templates/schedulecard.html"],function(a,b,c,d){var e=c.View.extend({template:b.template(d),events:{"click .poster":"onClickEditMovie","click .cancel-edit":"onClickCancelEditMovie","click .save-edit":"onClickSaveEditMovie"},onClickEditMovie:function(b){var c=a(b.target).closest(".schedule-card");return App.profile&&(c.find(".details").addClass("hidden"),c.find(".editor").removeClass("hidden")),!1},onClickCancelEditMovie:function(b){var c=a(b.target).closest(".schedule-card");return c.find(".details").removeClass("hidden"),c.find(".editor").addClass("hidden"),!1},onClickSaveEditMovie:function(b){this.onClickCancelEditMovie(b);var c=a(b.target).closest(".schedule-card"),d=c.find(".editor form"),e="POST",f=App.getApiBaseUrl()+"/live/schedule";null!==this.model.id&&(e="POST",f=App.getApiBaseUrl()+"/live/schedule/id/"+this.model.id);var g=this;return a.ajax({type:e,url:f,data:d.serialize(),dataType:"json",success:function(a){g.model=a,g.render()}}),!1},initialize:function(){},render:function(){return this.$el.html(this.template({movie:this.model})),this}});return e}),define("live/views/schedule",["jquery","underscore","backbone","text!live/templates/schedule.html","live/views/schedulecard"],function(a,b,c,d,e){var f=c.View.extend({template:b.template(d),events:{"click #next-month":"onClickNextMonth","click #last-month":"onClickLastMonth","click #add-schedule-card":"onClickAddScheduleCard"},onClickNextMonth:function(){var b=this;return a.getJSON(this.next_month.link,function(a){console.log(a),b.updateMovies(a)}),!1},onClickLastMonth:function(){var b=this;return a.getJSON(this.last_month.link,function(a){console.log(a),b.updateMovies(a)}),!1},onClickAddScheduleCard:function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear(),f={date:d+"-"+c+"-"+b,date_fmt:"UNK",id:null,imdb:null,poster:null,profile:null,synopsis:null,title:null,trailer:null},g=new e({model:f});return this.movieViews.push(g),this.render(),!1},initialize:function(){this.movieViews=[],this.rendered=!1,console.log("init schedule view");new Date},updateMovies:function(a){this.theme=a.theme,this.this_month=a.title,this.next_month=a.links.next_month,this.last_month=a.links.last_month,b.each(this.movieViews,function(a){a.setElement(null),a.close()},this),this.movieViews=[],b.each(a.movies,function(a){var b=new ScheduleCardView({model:a});this.movieViews.push(b)},this),this.rendered&&this.render()},close:function(){this.remove()},render:function(){this.rendered=!0;var a=[];return b.each(this.movieViews,function(b){a.push(b.model.date)}),this.$el.html(this.template({theme:this.theme,movie_dates:a,profile:{},this_month:this.this_month,next_month:this.next_month?this.next_month.title:null,last_month:this.last_month?this.last_month.title:null})),b.each(this.movieViews,function(a){a.setElement(this.$("#schedule-card-"+a.model.date)).render()},this),this}});return f}),define("text!live/templates/request.html",[],function(){return'\r\n<a id="trailer-anchor" href="#" class="hidden" target="_BLANK"></a>\r\n\r\n<div class="content-left">\r\n\r\n    <h1 class="full-width">SEARCH FOR A MOVIE <button class="show-schedule bordered">Show schedule</button></h1>\r\n\r\n    <form id="tmdb-search">\r\n        <input type="text" value="" placeholder="Search..." />\r\n        <button class="bordered green large">Search</button>\r\n    </form>\r\n\r\n    <div id="search-error" style="display: none"></div>\r\n\r\n    <div id="search-results" style="display: none">\r\n        <h2>SEARCH RESULTS <span style="color:#666">(<span id="search-result-count"></span>)</span></h2>\r\n\r\n        <div class="posters-container" style="display: none">\r\n            <!-- The actual isotope container for posters to be sorted -->\r\n            <div class="isotope-container"></div>\r\n        </div>\r\n\r\n        <!-- details view container -->\r\n        <div class="movie-details-container" style="display: none"></div>\r\n\r\n        <div id="too-many-results-warning" style="display:none">YOU HAVE TOO MANY RESULTS, NARROW YOUR SEARCH FOOL.</div>\r\n\r\n        <!--a id="search-next-page" href="#" style="display: none">Load Next Page</a-->\r\n    </div>\r\n</div>\r\n\r\n<div class="content-left">\r\n\r\n    <h1 class="full-width">MY MOVIES</h1>\r\n\r\n    <div id="favorites-list">\r\n\r\n        <div class="posters-container">\r\n        <% if (favorites.length > 0) { %>\r\n            <% _.each(favorites, function(movie, index) { %>\r\n                <div class="favorite-movie" data-favorite-index="<%- index %>">\r\n                    <img src="http://image.tmdb.org/t/p/w154/<%- movie.poster_path %>" \r\n                        alt="<%- movie.title %>" title="<%- movie.title %>" />\r\n                </div>\r\n            <% }) %>\r\n        <% } else { %>\r\n            No favorites!\r\n        <% } %>\r\n        </div>\r\n\r\n        <div class="movie-details-container" style="display: none"></div>\r\n    </div>\r\n\r\n</div>'}),define("text!live/templates/details.html",[],function(){return'\r\n<div class="movie-details" \r\n    data-search-result="<%- isSearchResult %>" \r\n    data-results-index="<%- index %>" \r\n    data-tmdb-id="<%- id %>"\r\n    style="background-image: url(\'<%- backdrop %>\')">\r\n    \r\n    <div class="left-controls">\r\n        <img class="poster" src="<%- poster %>">\r\n\r\n        <% if (isFavorited) { %>\r\n            <button class="bordered red">Remove</button>\r\n        <% } else { %> \r\n            <button class="bordered">Add to my list</button>\r\n        <% } %>\r\n    </div>\r\n\r\n    <a href="#" class="show-posters">Back to list</a>\r\n\r\n    <div class="details">\r\n        <h1>\r\n            <%- title %> \r\n            <span class="year">(<%- releaseDate %>)</span>\r\n        </h1>\r\n        \r\n        <dl>\r\n            <dt>Synopsis</dt>\r\n            <dd class="overview"><%- overview %></dd>\r\n\r\n            <dt>Voter Average</dt>\r\n            <dd class="vote-average">\r\n                <% for (var i = 0; i < 5; i++) { %>\r\n                    <% if (Math.ceil(voteAverage * 0.5) <= i) { %>\r\n                        &#9734;\r\n                    <% } else { %>\r\n                        &#9733;\r\n                    <% } %>\r\n                <% } %>\r\n            </dd>\r\n        </dl>\r\n\r\n    </div>\r\n\r\n    <div class="bottom-controls">\r\n        <button class="view-trailer bordered">Watch Trailer</button>\r\n        <button class="request-movie bordered green">Request this movie</button>\r\n    </div>\r\n</div>\r\n\r\n<% if (index > 0) { %>\r\n<a href="#" class="movie-details-prev">&lt;</a>\r\n<% } %>\r\n\r\n<% if (index < total - 1) { %>\r\n<a href="#" class="movie-details-next">&gt;</a>\r\n<% } %>\r\n\r\n\r\n'}),define("live/views/request",["jquery","underscore","backbone","isotope","text!live/templates/request.html","text!live/templates/details.html"],function(a,b,c,d,e,f){"use strict";var g=c.View.extend({template:b.template(e),detailsTemplate:b.template(f),TMDB_API_KEY:"7e02a059c9c5cc263b4db5f4ea7f9222",events:{"click #tmdb-search > button":"onSearch","enter #tmdb-search > input":"onSearch","click .search-result":"onClickSearchResult","click .favorite-movie":"onClickFavoriteMovie","click .movie-details-next":"onClickNextMovie","click .movie-details-prev":"onClickPrevMovie","click .show-posters":"onClickShowPosters","click .view-trailer":"onClickViewTrailer"},initialize:function(){this.favorites=[{adult:!1,backdrop_path:"/8EQg8fsxEElycBPSb0JszATwm1l.jpg",id:246403,original_language:"en",original_title:"Tusk",overview:"When his best friend and podcast co-host goes missing in the backwoods of Canada, a young guy joins forces with his friend's girlfriend to search for him.",popularity:2.808169,poster_path:"/ntxILPesM4IRumijc1DRJQTks9t.jpg",release_date:"2014-09-19",title:"Tusk",video:!1,vote_average:5,vote_count:82}]},close:function(){this.remove()},loadTrailer:function(b){a.getJSON("http://api.themoviedb.org/3/movie/"+b+"/videos?api_key="+this.TMDB_API_KEY).done(function(a){console.log(a);var b=null;for(var c in a.results)"YouTube"==a.results[c].site&&(b=a.results[c].key);b?alert("Found URI "+b+" but I can't open a new tab from JS. (lol popup blockers)"):alert("Could not retrieve a valid YouTube link from the TMDB API.")}).fail(function(){alert("An error occurred while contacting the TMDB API")})},onSearch:function(){var b=a("#tmdb-search > input").val();if(a("#tmdb-search > input").val(""),b.length<1)return!1;this.clearSearchResults();var c=this;a.getJSON("http://api.themoviedb.org/3/search/movie?api_key="+this.TMDB_API_KEY+"&query="+b).done(function(a){console.log(a),a.total_results>0?c.addSearchResults(a):c.displaySearchError("No results. "+c.getRandomPhrase())}).fail(function(){c.displaySearchError("An error occurred while contacting the TMDB API")});return!1},getRandomPhrase:function(){var a=['Did you mean to type "Tusk"?','Were you looking for <a href="https://www.youtube.com/watch?v=vUp5hU7W2_I" target="_BLANK">this</a>?','Were you looking for <a href="https://www.youtube.com/watch?v=BCUvx2BExZI" target="_BLANK">this</a>?','How about a <a href="https://www.youtube.com/watch?v=4_vHQOc4hUM" target="_BLANK">ggglygy video</a> instead?',"Are you sure you weren't looking for the true death note?","Does this thing even work?","Maybe only Blockbuster carried it?"];return b.sample(a)},displaySearchError:function(b){a("#search-error").show().html(b),a("#search-results").hide()},clearSearchResults:function(){a("#search-results .isotope-container").html(),this.currentSearchIndex=0,this.results=[],this.searchPagesLoaded=0,this.totalSearchPages=0,this.isotope.remove(this.isotope.getItemElements()),this.isotope.layout()},addSearchResults:function(c){this.results=this.results.concat(c.results),this.totalSearchPages=c.total_pages,this.page=c.page,a("#search-result-count").html(c.total_results+" match"+(c.total_results>1?"es":"")),c.page==c.total_pages?a("#search-next-page").hide():a("#search-next-page").show(),a("#search-error").hide();var d=[];b.each(c.results,function(b,c){console.log(b);var e=b.poster_path;e=e?"http://image.tmdb.org/t/p/w154/"+e:"/img/movie-tba.png";var f=a("<div/>").addClass("search-result").data("results-index",c).html('<img src="'+e+'" alt="'+b.title+'" title="'+b.title+'" />');f.css({width:"154px",height:"231px"}),d.push(f[0])}),a("#search-results .isotope-container").html(d),this.isotope.appended(d),a("#search-results").show(),c.total_results>1?(this.$el.find("#search-results .movie-details-container").hide(),this.$el.find("#search-results .posters-container").show()):1==c.total_results&&(this.currentSearchIndex=0,this.displayMovieDetails(this.$searchResults,c.results,0)),this.isotope.layout()},displayMovieDetails:function(a,b,c){var d=b[c],e=d.poster_path;e=e?"http://image.tmdb.org/t/p/w154/"+e:"/img/movie-tba.png";var f=d.backdrop_path;f&&(f="http://image.tmdb.org/t/p/w780/"+f);var g=d.release_date;g=!g||g.length<4?"????":g.substr(0,4);var h=!1;for(var i in this.favorites)if(this.favorites[i].id==d.id){h=!0;break}a.find(".posters-container").hide(),a.find(".movie-details-container").html(this.detailsTemplate({isSearchResult:!0,title:d.title,id:d.id,releaseDate:g,overview:d.overview,voteAverage:d.vote_average,poster:e,backdrop:f,index:c,total:b.length,isFavorited:h})).show()},onClickSearchResult:function(b){var c=a(b.currentTarget).data("results-index");return this.currentSearchIndex=c,this.displayMovieDetails(this.$searchResults,this.results,c),!1},onClickFavoriteMovie:function(b){var c=a(b.currentTarget).data("favorite-index");return this.displayMovieDetails(this.$favoritesList,this.favorites,c),!1},onClickNextMovie:function(a){return this.currentSearchIndex<this.results.length-1&&(this.currentSearchIndex++,this.displayMovieDetails(this.$searchResults,this.results,this.currentSearchIndex)),!1},onClickPrevMovie:function(){return this.currentSearchIndex>0&&(this.currentSearchIndex--,this.displayMovieDetails(this.$searchResults,this.results,this.currentSearchIndex)),!1},onClickShowPosters:function(b){var c=a(b.currentTarget).closest(".movie-details-container").parent();return c.find(".movie-details-container").hide(),c.find(".posters-container").show(),!1},onClickViewTrailer:function(b){var c=a(b.currentTarget).closest(".movie-details").data("tmdb-id");this.loadTrailer(c)},render:function(){return this.$el.html(this.template({favorites:this.favorites})),this.isotope||(this.isotope=new window.Isotope(a("#search-results .isotope-container")[0],{itemSelector:".search-result",layoutMode:"masonry"})),this.$searchResults=a("#search-results"),this.$favoritesList=a("#favorites-list"),this}});return g}),define("text!live/templates/index.html",[],function(){return'\r\n<!--div class="live-publisher hidden">\r\n    <div class="profile-icon small">\r\n        <img src="/img/default-profile-icon.png" />\r\n    </div>\r\n</div-->\r\n\r\n<div id="player-container">\r\n    <div id="live-offline"><h1>OFFLINE</h1></div>\r\n    <div id="live-error" class="hidden"><h1>Unknown Error</h1></div>\r\n    <div id="live-player-container" class="hidden">\r\n        <div id="live-player"><!-- Contents will be overwritten by Flowplayer --></div>\r\n    </div>\r\n</div>\r\n\r\n<div class="viewers"></div>\r\n<div id="schedule-view-container"></div>\r\n<div id="request-view-container"></div>'}),define("live/views/index",["jquery","underscore","backbone","flowplayer","live/models/live","live/views/viewers","live/views/schedule","live/views/request","text!live/templates/index.html"],function(a,b,c,d,e,f,g,h,i){var j=c.View.extend({template:b.template(i),events:{"click .show-schedule":"onClickShowSchedule","click .show-request":"onClickShowRequest"},initialize:function(){this.model=new e,this.model.on("change:publishing",this.onPublish,this).on("change:error",this.onError,this),this.Viewers=new f({model:this.model}),this.Schedule=new g({model:this.model}),a(window).on("resize.live",b.bind(this.onWindowResize,this)),this.model.startPolling()},close:function(){a(window).off("resize.live"),a(window).off("scroll.live"),this.model.stopPolling(),this.Viewers.close(),this.Schedule.close(),a("#header").removeClass("transparent"),this.remove()},onClickShowRequest:function(){return this.Request||(this.Request=new h({model:this.model}),this.Request.setElement(this.$("#request-view-container")).render()),this.$el.find("#schedule-view-container").hide(),this.$el.find("#request-view-container").show(),!1},onClickShowSchedule:function(){return this.Schedule||(this.Schedule=new g({model:this.model}),this.Schedule.setElement(this.$("#schedule-view-container")).render()),this.$el.find("#request-view-container").hide(),this.$el.find("#schedule-view-container").show(),!1},onUpdatePublisher:function(a){a.get("online")===!0?this.$(".live-publisher").removeClass("hidden"):this.$(".live-publisher").addClass("hidden")},onPublish:function(){console.log("ON PUBLISH: ",this.model.get("publishing")),this.model.get("publishing")===!0?this.startRtmpPlayback(this.model.get("stream_path"),this.model.get("rtmp_url")):this.stopPlayback()},onError:function(){console.log("ON ERROR: ",this.model.get("error")),void 0!==this.model.get("error")?this.showPlayerError(this.model.get("error")):this.stopPlayback()},render:function(){return Sybolt.header.setStyle("live"),this.$el.html(this.template({})),this.Viewers.setElement(this.$("#viewers-view-container")).render(),this.Schedule.setElement(this.$("#schedule-view-container")).render(),this.onWindowResize(),this.onWindowResize(),this},onWindowResize:function(){var b=a(window).height(),c=a(window).width();c/b>1.7778?(a("#player-container").height(b).width(c),a("#live-player-container").height(b).width(1.7778*b)):(a("#player-container").height(c/1.7778).width(c),a("#live-player-container").height(c/1.7778).width(c))},startRtmpPlayback:function(b,c){a("#live-error").addClass("hidden"),a("#live-offline").addClass("hidden"),a("#live-player-container").removeClass("hidden"),$f("live-player")&&$f("live-player").isLoaded()?$f("live-player").isPlaying()||(console.log("Loading Source playback"),$f("live-player").play({url:b})):(console.log("Initializing player"),$f("live-player",{src:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",wmode:"opaque"},{clip:{url:b,live:!0,scaling:"fit",provider:"rtmp",autoPlay:!0},onBeforePause:function(){return!1},plugins:{rtmp:{url:"flowplayer.rtmp-3.2.13.swf",netConnectionUrl:c,inBufferSeek:!1},controls:{backgroundColor:"transparent",backgroundGradient:"none",progressColor:"#685475",bufferColor:"#dfcd6a",autoHide:!0,all:!1,play:!1,volume:!0,mute:!0,time:!1,fullscreen:!0,scrubber:!0,scrubberHeightRatio:.1,scrubberBarHeightRatio:.1,sliderColor:"#ffffff"}},canvas:{backgroundColor:"#2e2c2a",backgroundGradient:"none"}}),$f("live-player").play({url:b}))},showPlayerError:function(b){a("#live-offline").addClass("hidden"),a("#live-player-container").addClass("hidden"),a("#live-error").removeClass("hidden").find("h1").html("Connection Error: "+b),$f("live-player")&&$f("live-player").stop()},stopPlayback:function(){a("#live-error").addClass("hidden"),a("#live-player-container").addClass("hidden"),a("#live-offline").removeClass("hidden"),$f("live-player")&&$f("live-player").stop()}});return j}),define("live",["live/views/index"],function(a){var b={getView:function(){return a}};return b})}();
//# sourceMappingURL=live.min.js.map