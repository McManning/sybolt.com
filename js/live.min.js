/*! Sybolt 13-02-2016 */
var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a};return function(e,f,g){var h=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(f=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]),"UTC:"==f.slice(0,4)&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",j=e[i+"Date"](),k=e[i+"Day"](),l=e[i+"Month"](),m=e[i+"FullYear"](),n=e[i+"Hours"](),o=e[i+"Minutes"](),p=e[i+"Seconds"](),q=e[i+"Milliseconds"](),r=g?0:e.getTimezoneOffset(),s={d:j,dd:d(j),ddd:h.i18n.dayNames[k],dddd:h.i18n.dayNames[k+7],m:l+1,mm:d(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(m).slice(2),yyyy:m,h:n%12||12,hh:d(n%12||12),H:n,HH:d(n),M:o,MM:d(o),s:p,ss:d(p),l:d(q,3),L:d(q>99?Math.round(q/10):q),t:12>n?"a":"p",tt:12>n?"am":"pm",T:12>n?"A":"P",TT:12>n?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(r>0?"-":"+")+d(100*Math.floor(Math.abs(r)/60)+Math.abs(r)%60,4),S:["th","st","nd","rd"][j%10>3?0:(j%100-j%10!=10)*j%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(a,b){return dateFormat(this,a,b)},$(function(){function a(){window.scrollY>$("#player-container").height()-100?$("header").removeClass("transparent"):$("header").addClass("transparent")}function b(a){k=!0,$("#live-error").hide(),$("#live-offline").hide(),$("#live-player-container").show(),$f("live-player")&&$f("live-player").isLoaded()?$f("live-player").isPlaying()||(console.log("Loading Source playback"),$f("live-player").play({url:a.stream_path})):(console.log("Initializing player"),$f("live-player",{src:"https://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",wmode:"opaque"},{clip:{url:a.stream_path,live:!0,scaling:"fit",provider:"rtmp",autoPlay:!0},onBeforePause:function(){return!1},plugins:{rtmp:{url:"flowplayer.rtmp-3.2.13.swf",netConnectionUrl:a.rtmp_url,inBufferSeek:!1,rtmpt:!1},controls:{backgroundColor:"transparent",backgroundGradient:"none",progressColor:"#685475",bufferColor:"#dfcd6a",autoHide:!0,all:!1,play:!1,volume:!0,mute:!0,time:!1,fullscreen:!0,scrubber:!0,scrubberHeightRatio:.1,scrubberBarHeightRatio:.1,sliderColor:"#ffffff"}},canvas:{backgroundColor:"#2e2c2a",backgroundGradient:"none"}}),$f("live-player").play({url:a.stream_path}))}function c(){k&&(k=!1,$("#live-error").hide(),$("#live-player-container").hide(),$("#live-offline").show(),$f("live-player")&&$f("live-player").stop())}function d(a){a.length>0?$("header .logo-badge").show().html(a.length+" viewer"+(a.length>1?"s":"")):$("header .logo-badge").hide()}function e(a){$("#live-offline").hide(),$("#live-player-container").hide(),$("#live-error").show().find("h1").html("Connection Error: "+a),$f("live-player")&&$f("live-player").stop()}function f(){var a=$(window).height(),b=$(window).width();b/a>1.7778?($("#player-container").height(a).width(b),$("#live-player-container").height(a).width(1.7778*a)):($("#player-container").height(b/1.7778).width(b),$("#live-player-container").height(b/1.7778).width(b))}function g(){$.getJSON("/live/status").done(function(a){console.log(a),a.error?e(a.error):(a.publishing&&!k&&b(a),!a.publishing&&k&&(c(),d([])),a.clients&&d(a.clients))}).fail(function(){e("Error while syncing to Live API")}),setTimeout(g,5e3)}function h(a,b){j=new Date(a.getTime());var c=$(".schedule-page");c.parent().append(b),c.slideUp(200,function(){$(this).remove()}),$("#this-month").html(a.format("mmmm yyyy")),a.setMonth(a.getMonth()+1),$("#next-month").html(a.format("mmmm yyyy")),a.setMonth(a.getMonth()-2),$("#last-month").html(a.format("mmmm yyyy")),$("i.krampusvote-vote").click(function(){var a=$(this).closest(".movie-card"),b=$(this).hasClass("nice")?"nice":"naughty";$.post("/krampusvote/vote/movie",{type:b,id:a.data("movie-id")}).done(function(c){"error"in c?alert(c.error):(a.find("i.krampusvote-vote").hide(),a.find(".krampusvote-result").addClass(b),a.find("p.krampusvote-vote").addClass(b).text(b))})})}function i(a){$.get("/live/schedule/"+(a.getMonth()+1)+"/"+a.getFullYear()).done(function(b){h(a,b)}).fail(function(){alert("Failed to load schedule page")}).always(function(){})}var j=new Date,k=!1;i(j),$(".modal-trigger").leanModal(),$(".modal-trigger").click(function(a){return a.preventDefault(),!1}),$(window).on("resize.live",f),f(),f(),g(),$(window).scroll(function(){a()}),a(),$("#next-month").click(function(){var a=new Date(j.getTime());return a.setMonth(a.getMonth()+1),i(a),!1}),$("#last-month").click(function(){var a=new Date(j.getTime());return a.setMonth(a.getMonth()-1),i(a),!1}),$("#stop2spooky").click(function(){return $(this).hide(),$(".spooky-vision").hide(),!1})});